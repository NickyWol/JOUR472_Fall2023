---
title: "Data Analysis Project"
author: "Sasha Allen, Laura Charleston, Nicholas Wolcott"
date: "11/30/23"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(tidytext)
library(readr)
library(janitor)
library(refinr)
library(lubridate)
library(tidycensus)
```

## Load and Cleaning Data

Load and clean the core data set to prepare for analysis.

Show basic exploratory analysis to demonstrate an understanding of the dataset, including the number of rows and columns, any obvious limitations or flaws and any reasons why it might not be able to answer the questions you've listed last week.

Describe the limits of the data in terms of timeframe, what is and is not included and any codes or other information you'd need to find definitions for, and what you've done to better define it.

```{r}
# Load required data

MD_Grant_Loan_Data <- read.csv('data/State_of_Maryland_Grant_and_Loan_Data__FY2009_to_FY2022.csv') |>
  clean_names() 

census_api_key("c4b6d5f557fdd710f546c349eadd47d75c37b8aa", install=TRUE, overwrite=TRUE)
readRenviron("~/.Renviron")

Sys.getenv("CENSUS_API_KEY")
# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed. 
```

## Questions to answer

In this notebook, we are beginning to explore how to answer our five questions from the first Data Analysis Deliverable.

### Question 1
How has the amount of grants and loans and the number handed out changed over time?

Findings: We found that 2020 was the year that the most grants and loans were distributed, and where the most money was spent. This could be due to a surplus in government spending during the pandemic, because so many things were shut down.

```{r}
# Put code to reverse engineer sentence here

number_loans_overtime <- MD_Grant_Loan_Data |>
  group_by(fiscal_year) |>
  summarize(yearly_amount = n()) |>
  arrange(desc(yearly_amount))

amount_loans_over_time <- MD_Grant_Loan_Data |>
  group_by(fiscal_year)|>
  summarize(yearly_sum = sum(amount)) |>
  arrange(yearly_sum)

# Display results of code below this codeblock

```

### Question 2

Which department spent the most money on grants and loans?

Limitations: Could not filter by department and get good results because of varying department names.

```{r}

cleaned_MD_Grant_Loan_Data <- MD_Grant_Loan_Data |>
  mutate(cleaned_MD_Grant_Loan_Data = key_collision_merge(grantor)) |>
  select(grantor, cleaned_MD_Grant_Loan_Data, everything())

MD_Grant_Loan_Data |>
  group_by(grantor) |>
  summarize(department_sum = sum(amount)) |>
  arrange(desc(department_sum)) 

# Display results of code below this codeblock
```

### Question 3
What zip codes or counties receive the most grants from the state of Maryland and why?

Limitations: Zipcodes include 6 and 9 digit codes

```{r}
zipcode_organization <- MD_Grant_Loan_Data |>
  
  group_by(zip_code)|>
  summarize(zip_sum = sum(amount)) |>
  arrange(desc(zip_sum))

```


-30-
